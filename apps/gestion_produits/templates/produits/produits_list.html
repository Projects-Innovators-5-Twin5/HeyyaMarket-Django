<div class="table-responsive text-nowrap m-4">
    <table class="table">
        <thead class="table-dark">
            <tr>
                <th>Image</th>
                <th>Nom</th>
                <th>Description</th>
                <th>Stock</th>
                <th>Prix</th>
                <th>Catégorie</th> <!-- Ajout de la colonne Catégorie -->
                <th>Actions</th>
            </tr>
        </thead>
        <tbody class="table-border-bottom-0">
            {% if produits %}
                {% for produit in produits %}
                <tr>
                    <td><img src="../media/{{ produit.image }}" width="65px" height="35px"></td>
                    <td><span>{{ produit.nom }}</span></td>
                    <td>{{ produit.description|slice:":50" }}{% if produit.description|length > 50 %}...{% endif %}</td> 
                    <td>{{ produit.stock }}</td> 
                    <td>{{ produit.prix }} TND</td> 
                    <td>{{ produit.categorie.nom }}</td> 
                    <td>
                        <div class="dropdown">
                            <button type="button" class="btn p-0 dropdown-toggle hide-arrow" data-bs-toggle="dropdown">
                                <i class="ri-more-2-line"></i>
                            </button>
                            <div class="dropdown-menu">
                                <a class="dropdown-item" href="javascript:void(0);" data-bs-toggle="modal" data-bs-target="#editProduitModal" 
                                   data-url="{% url 'product_edit' produit.pk %}">
                                   <i class="ri-pencil-line me-1"></i> Modifier
                                </a>
                                <a class="dropdown-item" href="javascript:void(0);" data-bs-toggle="modal" data-bs-target="#deleteConfirmationModal" data-type="ce produit" data-url="{% url 'product_delete' produit.pk %}">
                                   <i class="ri-delete-bin-6-line me-1"></i> Supprimer
                                </a>
                            </div>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            {% else %}
                <tr>
                    <td colspan="7" class="text-center">Pas de produits disponibles</td>
                </tr>
            {% endif %}
        </tbody>
    </table>
</div>

<!-- Pagination -->
<nav aria-label="Page navigation">
    <ul class="pagination pagination-rounded pagination-outline-primary justify-content-center">
        {% if produits.has_previous %}
            <!-- First Page Link -->
            <li class="page-item first">
                <a class="page-link" href="?page=1">
                    <i class="tf-icon ri-skip-back-mini-line ri-22px"></i>
                </a>
            </li>
            <!-- Previous Page Link -->
            <li class="page-item prev">
                <a class="page-link" href="?page={{ produits.previous_page_number }}">
                    <i class="tf-icon ri-arrow-left-s-line ri-22px"></i>
                </a>
            </li>
        {% else %}
            <!-- Disabled First and Previous Links if there's no previous page -->
            <li class="page-item first disabled">
                <a class="page-link" href="javascript:void(0);">
                    <i class="tf-icon ri-skip-back-mini-line ri-22px"></i>
                </a>
            </li>
            <li class="page-item prev disabled">
                <a class="page-link" href="javascript:void(0);">
                    <i class="tf-icon ri-arrow-left-s-line ri-22px"></i>
                </a>
            </li>
        {% endif %}

        <!-- Page Numbers -->
        {% for i in produits.paginator.page_range %}
            {% if produits.number == i %}
                <li class="page-item active">
                    <a class="page-link" href="javascript:void(0);">{{ i }}</a>
                </li>
            {% else %}
                <li class="page-item">
                    <a class="page-link" href="?page={{ i }}">{{ i }}</a>
                </li>
            {% endif %}
        {% endfor %}

        {% if produits.has_next %}
            <!-- Next Page Link -->
            <li class="page-item next">
                <a class="page-link" href="?page={{ produits.next_page_number }}">
                    <i class="tf-icon ri-arrow-right-s-line ri-22px"></i>
                </a>
            </li>
            <!-- Last Page Link -->
            <li class="page-item last">
                <a class="page-link" href="?page={{ produits.paginator.num_pages }}">
                    <i class="tf-icon ri-skip-forward-mini-line ri-22px"></i>
                </a>
            </li>
        {% else %}
            <!-- Disabled Next and Last Links if there's no next page -->
            <li class="page-item next disabled">
                <a class="page-link" href="javascript:void(0);">
                    <i class="tf-icon ri-arrow-right-s-line ri-22px"></i>
                </a>
            </li>
            <li class="page-item last disabled">
                <a class="page-link" href="javascript:void(0);">
                    <i class="tf-icon ri-skip-forward-mini-line ri-22px"></i>
                </a>
            </li>
        {% endif %}
    </ul>
</nav>
{% include 'produits/update_produit.html' %}
{% include 'categories/confirmation_suppression.html' %}
